#include "head.h"

/*
 *æ–°å¢å‡½æ•°æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå…¶ä¸­caret()ä½œä¸ºæœ¬æ–‡ä»¶ä¸­çš„ä¸»å‡½æ•°ï¼Œä¸»è¦å®ç°æ–°å¢å­¦ç”Ÿçš„ä¿¡æ¯çš„åŠŸèƒ½ï¼Œå¹¶ä¸”è¦æŠŠç”¨æˆ·çš„è¾“å…¥è½¬åŒ–ä¸ºæ–‡ä»¶ã€‚
 *è€å®è¯´ï¼Œæœ‰ç‚¹éš¾åº¦ã€‚ä¸è¿‡æˆ‘å–œæ¬¢ã€‚
 * */
int a,b;//aæ˜¯ç§‘ç›®æ•°ï¼Œbæ˜¯äººæ•°.
char name[Subject][30]={0};
int choice_caret=0;
char filename[50]="å­¦ç”Ÿæˆç»©æ•°æ®.bat";

//è¿™ä¸ªæ–‡ä»¶çš„ä¸»å‡½æ•°
int caret_main()
{
	printf("=================æ¬¢è¿æ¥åˆ°å­¦ç”Ÿæˆç»©ç®¡ç†ç³»ç»Ÿçš„æ–°å¢ç•Œé¢ï¼==============\n");
	printf("====================================================================\n");
	printf("=                   1,æŸ¥çœ‹ä¹‹å‰çš„æ‰€æœ‰ä¿¡æ¯ã€‚                         =\n");
	printf("=                   2,å›é€€è‡³ä¸»ç•Œé¢ã€‚                               =\n");
	printf("=                   3,æ–°å¢å­¦ç”Ÿä¿¡æ¯ã€‚                               =\n");
	printf("=                   4,æŒ‰æˆç»©é«˜ä½æŸ¥çœ‹æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯ã€‚                 =\n");
	printf("\n");
	printf("           	â™€ å¥³é’å¹´ ASCII è‰ºæœ¯\n");
	printf("\n");
    	printf("           â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®\n");
   	printf("           â”‚    â•­â”€â”€â”€â•®    â”‚\n");
   	printf("           â”‚    â”‚ â€¢ â€¢â”‚   â”‚  ğŸ’\n");
	printf("           â”‚    â•°â”€â”¬â”€â•¯    â”‚\n");
	printf("           â•°â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â•¯\n");//çµæ´»è¿ç”¨printfä¹Ÿæ˜¯ç›¸å½“ä¸é”™çš„å•Šï¼
  	printf("            â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”\n");
 	printf("            â”‚    / \\    â”‚\n");
   	printf("            â”‚   â”‚   â”‚   â”‚\n");
  	printf("            â”‚   â”‚   â”‚   â”‚\n");
   	printf("            â”‚  â•±   â•±    â”‚\n");
   	printf("            â””â”€â•±â”€â”€â”€â•±â”€â”€â”€â”€â”€â”˜\n");
   	printf("              â•°â”€â”€â”€â•¯\n");
   	printf("\n");
   	printf("           â†“ è¯·åœ¨æ­¤è¾“å…¥\n");
   	printf("â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–\r");
   	scanf("%d",&choice_caret);
    	switch(choice_caret)
	{
		case 1:
			//cha_kan();
			break;
		case 2:
			return 0;//ç›´æ¥ç»“æŸè¿™ä¸ªå‡½æ•°çš„è¿è¡Œï¼Œè€Œä¸»å‡½æ•°å°±ä¼šå¼€å§‹å¾ªç¯ï¼Œç­‰åŒäºå›åˆ°ä¸»ç•Œé¢ã€‚
			break;
		case 3:
			struct stu *q=caret();//ä½¿ç”¨æ–°å¢å‡½æ•°
			fprintf_caret(q);//æŠŠç”¨æˆ·çš„è¾“å…¥å†™æˆæ–‡ä»¶
			break;
		case 4:
			//an_cheng_print();//å®šä¹‰ä¸€ä¸ªå‡½æ•°æŠŠå­¦ç”Ÿä¿¡æ¯æŒ‰ä»é«˜åˆ°ä½è¾“å‡ºã€‚
			break;
	}
	return 0;
}

//è¿™å¯ä»¥ä½œä¸ºæ–°å¢ç•Œé¢å‡½æ•°çš„ç¬¬ä¸€ä¸ªå­å‡½æ•°ã€‚
void input_we()//å‡½æ•°çš„å®šä¹‰
{
	int i;//å£°æ˜ç¬¬ä¸€ä¸ªå±€éƒ¨å˜é‡
	int k1;//ç¬¬äºŒä¸ªå±…éƒ¨å˜é‡k1
	while(1)
	{
		printf("è¯·é—®æ‚¨è¦ç»Ÿè®¡å‡ é—¨å­¦ç§‘çš„æˆç»©ï¼š");
		printf("___\b\b");//ä¸ºäº†æ›´ä¼˜é›…
		k1=scanf("%d",&a);
		if(a>Subject || a<=0)
		{
			printf("ä¸å¥½æ„æ€ï¼Œè¿™ä¸ªç³»ç»Ÿæœ€å¤§çš„ç§‘ç›®æ•°ä¸º9,è¯·æ‚¨é‡æ–°è¾“å…¥ï¼\n");
			continue;
		}
		if(k1!=1)
		{
			printf("ä¸å¥½æ„æ€ï¼Œè¯·ä¸è¦è°ƒçš®ï¼Œè¯·è¾“å…¥æ•°å­—è€Œä¸æ˜¯å…¶å®ƒï¼Œæ¯”å¦‚æŒ‰äº†ctrl + dï¼Œæˆ–è€…æ˜¯è¾“å…¥äº†abcä¹‹ç±»çš„ã€‚\n");
			printf("æ€»è€Œè¨€ä¹‹ï¼Œè¯·æ‚¨é‡æ–°è¾“å…¥ï¼\n");
			continue;
		}
		break;
	}

	//æ¥ä¸‹æ¥è¯¢é—®æ¯ä¸€é—¨ç§‘ç›®çš„åå­—
	for(i=0;i<a;i++)
	{
		printf("è¯·é—®ç¬¬%dé—¨ç§‘ç›®çš„åå­—æ˜¯ï¼š",i+1);
		scanf("%s",&name[i]);//ä½¿ç”¨æ•°ç»„è€Œä¸æ˜¯ç»“æ„ä½“ã€‚
	}
	//æ¥ä¸‹æ¥é—®è¦è¾“å…¥çš„å­¦ç”Ÿæ•°
	while(1)
	{
		printf("è¯·é—®æ‚¨è¦è¾“å…¥å¤šå°‘ä¸ªäººçš„æˆç»©ï¼Ÿï¼ˆé—®äººæ•°ï¼‰ï¼š");
		k1=scanf("%d",&b);
		if(b<0)
		{
			printf("ä¸å¥½æ„æ€ï¼Œæ‚¨çš„è¾“å…¥æœ‰è¯¯ï¼Œè¯·æ‚¨é‡æ–°è¾“å…¥ï¼\n");
			continue;
		}
		if(k1!=1)
		{
			printf("ä¸å¥½æ„æ€ï¼Œè¯·ä¸è¦è°ƒçš®ï¼Œè¯·è¾“å…¥æ•°å­—è€Œä¸æ˜¯å…¶å®ƒï¼Œæ¯”å¦‚æŒ‰äº†ctrl + dï¼Œæˆ–è€…æ˜¯è¾“å…¥äº†abcä¹‹ç±»çš„ã€‚\n");
			printf("æ€»è€Œè¨€ä¹‹ï¼Œè¯·æ‚¨é‡æ–°è¾“å…¥ï¼\n");
			continue;
		}
		break;
	}

	//æ¥ä¸‹æ¥å°±æ˜¯é—®æ¯ä¸€ä¸ªäººçš„å…·ä½“ä¿¡æ¯äº†
	//è¿™å¾—å®šä¹‰ä¸€ä¸ªç»“æ„ä½“æ•°ç»„ï¼Œæœ€å¤§å®¹é‡ä¸º50,ä¹Ÿå°±æ˜¯hunmançš„å€¼ã€‚
	//è¿™ä¸ªç»“æ„ä½“æ•°ç»„å¿…é¡»æ˜¯å£°ååœ¨å¤´æ–‡ä»¶ä¸­çš„ã€‚
	
								
}//ç¬¬ä¸€ä¸ªå‡½æ•°æ€»ç®—å†™å®Œäº†ã€‚ä¹Ÿä¸éš¾ï¼Œå°±æ˜¯éœ€è¦è€å¿ƒå’Œæ—¶é—´ã€‚

//æœ¬æ–‡ä»¶çš„ç¬¬2ä¸ªå­å‡½æ•°
void input(struct stu *p,int i)
{
	char xuan;
	int j=0,k1=0;//å£°æ˜ç¬¬å››ä¸ªå±€éƒ¨å˜é‡
	printf("è¯·è¾“å…¥ç¬¬%dä¸ªå­¦ç”Ÿçš„å§“åï¼š",i+1);
	scanf("%s",&p->name);
	while(1)
	{
		printf("è¯·é€‰æ‹©ç¬¬%dä¸ªå­¦ç”Ÿ%sçš„æ€§åˆ«ï¼š\n",i+1,p->name);
		printf("a,ç”·/man\n");
		printf("b,å¥³/weman\n");
		printf("æ‚¨çš„é€‰æ‹©ï¼š");
		printf("___\b\b");
		scanf("%c",&xuan);
		switch(xuan)
		{
			case 'a':
				p->nan_or_nv=a;	
				break;
			case 'b':
				p->nan_or_nv=b;
				break;
			case 'A':
				p->nan_or_nv=a;
				break;
			case 'B':
				p->nan_or_nv=b;
				break;
			default:
				printf("ä¸å¥½æ„æ€ï¼Œè¯·ä¸è¦ä¹±è¾“æ•°æ®å“¦ï¼\n");
				printf("è¯·é‡æ–°è¾“å…¥ï¼š\n");
				continue;
		}
		break;
	}
	//æ¥ä¸‹æ¥æ˜¯å­¦ç”Ÿçš„å¹´é¾„ã€‚
	while(1)
	{
			printf("è¯·è¾“å…¥ç¬¬%dä¸ªå­¦ç”Ÿ%sçš„å¹´é¾„ï¼š",i+1,p->name);
			k1=scanf("%d",&p->age);
			if(p->age>90 || p->age<0 || k1!=1)
			{
				printf("è¯·ä¸è¦ä¹±è¾“æ•°æ®ï¼\n");
				printf("è¯·é‡æ–°è¾“å…¥ï¼\n");
				continue;
			}
			break;
	}

	//æœ€åæ˜¯å­¦ç”Ÿçš„å„ä¸ªç§‘ç›®çš„æˆç»©
	for(j=0;j<a;j++)//aæ˜¯å£°æ˜åœ¨å¤´æ–‡ä»¶ä¸­çš„å…¨å±€å˜é‡ï¼Œå‚¨å­˜çš„æ˜¯ç§‘ç›®çš„æ•°é‡
	{
		while(1)
		{
			printf("è¯·æ‚¨è¾“å…¥ç¬¬%dä¸ªå­¦ç”Ÿ%sçš„%sç§‘ç›®çš„æˆç»©ï¼š",i+1,p->name,name[j]);
			k1=scanf("%d",&p->chengji[j]);
			if(k1!=1)
			{
				printf("è¯·ä¸è¦ä¹±è¾“æ•°æ®ï¼\n");
				printf("è¯·é‡æ–°è¾“å…¥ï¼\n");
				continue;
			}
			break;
		}
	}
}

//æœ¬æ–‡ä»¶çš„ç¬¬ä¸‰ä¸ªå­å‡½æ•°
struct stu *caret()//ç”¨æˆ·è¾“å…¥çš„äººæ•°å’Œè¾“å…¥çš„ç§‘ç›®æ•°å¯ä»¥ä½œä¸ºå…¨å±€å˜é‡ï¼Œæ²¡æœ‰å¿…è¦ä¼ å‚ã€‚
{
	input_we();
	struct stu *q,*p,*head;
	int i;
	if((head=(struct stu*)malloc(sizeof(struct stu)))==NULL)
	{
			printf("error!!");
			return 0;
	}
	head->next=NULL;
	q=head;
	for(i=0;i<b;i++)//bæ˜¯äººæ•°
	{
		if((p=(struct stu *)malloc(sizeof(struct stu)))==NULL)
		{
			printf("error!!!");
			return 0;
		}
		//æ€è€ƒä¸€ä¸‹ï¼Œæ€ä¹ˆå……åˆ†åˆ©ç”¨ä¹‹å‰å†™çš„å‡½æ•°
		//å¾ˆæ˜æ˜¾,ç¯è¿ç•Œé¢åªéœ€è¦å‡ºç°ä¸€æ¬¡å°±è¡Œäº†ï¼Œè€Œè¦è¯¢é—®æ¯ä¸€ä¸ªå­¦ç”Ÿçš„ä¿¡æ¯çš„éƒ¨åˆ†å¾—å‡ºç°å¤šæ¬¡ï¼Œä¹‹å‰æˆ‘æ˜¯ç”¨æ•°ç»„å­˜æ•°æ®ï¼Œç°åœ¨è¦æ”¹ç”¨é“¾è¡¨äº†ã€‚
		//æœ€å¹²å‡€åˆ©è½çš„æ–¹æ³•å°±æ˜¯é‡å†™ã€‚
		input(p,i);
		q->next=p;
		q=p;
	}
	p->next=NULL;
	return head;
}


void fprintf_caret(struct stu *head)
{
	int i=0,j=0;
	FILE *p;
	if((p=fopen(filename,"w"))==NULL)
	{
		printf("error!!!");
		return;
	}
	head=head->next;
	fprintf(p,"\tå§“å\t\tå¹´é¾„\t\tæ€§åˆ«\t\t");
	for(i=0;i<a;i++)
		fprintf(p,"%s\t",name[i]);
	fprintf(p,"\n");
	while(head!=NULL)
	{
		fprintf(p,"%10s \t %10d \t %c \t",head->name,head->age,head->nan_or_nv);
		for(j=0;j<a;j++)
			fprintf(p,"%d\t",head->chengji[j]);
		fprintf(p,"\n");
		head=head->next;
	}
}



